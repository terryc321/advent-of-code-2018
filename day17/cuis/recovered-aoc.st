Morph subclass: #Day17Morph	instanceVariableNames: 'origin box_size water walls'	classVariableNames: ''	package: 'Advent-Of-Code-2018'!!Day17Morph commentStamp: '2025-11-15T10:38:30.046409+00:00' prior: 0!pharo system browser 14 development does not show correct class definition !!```d := Day17 new.d range: ( d puzzleInput1).dm := Day17Morph new.dm openInWorld.dm plotWalls: d . whatever pass to (dm plot:) has to support points , minX ,minY,maxX,maxY ,also if we want to plot water ```!!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:19.218269+00:00'!drawOn: aCanvas   | position rect0 rect1 rect2 midpoint extent farCorner|" walls - supports points ,minX,minY,maxX,maxY "" water - supports points - computed from walls " position := self position. extent := self extent . midpoint := self position + (extent / 2). farCorner := position + extent .  rect0 := (position corner: farCorner). rect1 := (position corner: midpoint).  rect2 := (midpoint corner: farCorner). aCanvas fillRectangle: rect0 color: (Color black). " aCanvas fillRectangle: rect1 color: (Color green)."" aCanvas fillRectangle: rect2 color: (Color red)."" for all points in diagram starting from top left (dat minX , dat minY) to (dat maxX , dat maxY)"walls ifNotNil: [ "walls plotted brown"walls points do: [ :pt | 		self plotPoint: pt onCanvas: aCanvas withColor: Color brown.	]." draw the sprinkler - nice bright green  " self plotPoint: (500@0) onCanvas: aCanvas withColor: Color green. self plotPoint: (499@(0-1)) onCanvas: aCanvas withColor: Color green. self plotPoint: (501@(0-1)) onCanvas: aCanvas withColor: Color green. self plotPoint: (498@(0-2)) onCanvas: aCanvas withColor: Color green. self plotPoint: (502@(0-2)) onCanvas: aCanvas withColor: Color green.]."plot the water as blue "water ifNotNil:[water points do: [ :pt | 		self plotPoint: pt onCanvas: aCanvas withColor: Color blue.			]].	! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.587902+00:00'!click: anEventTranscript show: 'mouse click ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.592641+00:00'!containsPoint: aPoint  | position rect0 midpoint extent farCorner|  "if morph contains point - ask its rectangle if it knows " position := self position. extent := self extent . midpoint := self position + (extent / 2). farCorner := position + extent .  rect0 := (position corner: farCorner). ^ rect0 containsPoint: aPoint . ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.593906+00:00'!doubleClick: anEventTranscript show: 'mouse double click ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.594769+00:00'!handlesMouseDown: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.595854+00:00'!handlesMouseEnter: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.59667+00:00'!handlesMouseLeave: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.597313+00:00'!handlesMouseOver: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.600777+00:00'!keyStroke: anEvent | keyValue | Transcript show: ' key stroke ' ; show: anEvent  ; show: ' kv=' ; show: anEvent keyValue ;  cr . keyValue := anEvent keyValue. keyValue = 30 "up arrow "   ifTrue: [ 	Transcript show: ' up arrow ' ; cr . 	    origin := origin - (0@1).	 ]. keyValue = 31 "down arrow "   ifTrue: [ 	Transcript show: ' down arrow ' ; cr.		    origin := origin + (0@1).	 ]. keyValue = 29 "right arrow "   ifTrue: [ 	Transcript show: ' right arrow ' ; cr . 		    origin := origin + (1@0).	 ]. keyValue = 28 "left arrow "   ifTrue: [ 	Transcript show: ' left arrow ' ; cr . 			    origin := origin - (1@0).	 ].	Transcript show: ' keystroke origin => ' ; show: origin ; cr .   ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.602133+00:00'!mouseDown: anEvent"also handleMouseDown: anEvent ""which is about system framework level code "Transcript show: 'mouse down ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.602826+00:00'!mouseEnter: anEvent anEvent hand newKeyboardFocus: self .Transcript show: 'mouse entered ' ; show: anEvent ; cr . ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.603476+00:00'!mouseEnterDragging: anEventTranscript show: 'mouse entered dragging ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.604135+00:00'!mouseLeave: anEvent anEvent hand newKeyboardFocus: nil .Transcript show: 'mouse leave ' ; show: anEvent ; cr . ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.604719+00:00'!mouseLeaveDragging: anEventTranscript show: 'mouse leave dragging ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.605234+00:00'!mouseMove: anEventTranscript show: 'mouse move ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.605737+00:00'!mouseOver: anEventTranscript show: 'mouse over ' ; show: anEvent ; cr .  ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.606267+00:00'!mouseStillDown: anEventTranscript show: 'mouse still down ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.606747+00:00'!mouseUp: anEventTranscript show: 'mouse up ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.607204+00:00'!startDrag: anEventTranscript show: 'mouse start drag ' ; show: anEvent ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.607678+00:00'!step"do something if we are asked to startStepping / stopStepping" ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.608318+00:00'!stepTime"in milliseconds"  ^ 1000 ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.608738+00:00'!wantsSteps  ^ false! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.609292+00:00'!wantsStepsWhenCollapsed  ^ false! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.609656+00:00'!handlesMouseClick: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.609992+00:00'!handlesMouseDoubleClick: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.612346+00:00'!handlesKeyStroke: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.612691+00:00'!handlesKeyboard: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.614662+00:00'!keyDown: anEvent | keyValue |  Transcript show: ' key down ' ; show: anEvent  ; show: ' kv=' ; show: anEvent keyValue ;  cr . Transcript show: ' key stroke ' ; show: anEvent  ; show: ' kv=' ; show: anEvent keyValue ;  cr . keyValue := anEvent keyValue. keyValue = 30 "up arrow "   ifTrue: [ 	Transcript show: ' up arrow ' ; cr . 	    origin := origin - (0@10).	 ]. keyValue = 31 "down arrow "   ifTrue: [ 	Transcript show: ' down arrow ' ; cr.		    origin := origin + (0@10).	 ]. keyValue = 29 "right arrow "   ifTrue: [ 	Transcript show: ' right arrow ' ; cr . 		    origin := origin + (10@0).	 ]. keyValue = 28 "left arrow "   ifTrue: [ 	Transcript show: ' left arrow ' ; cr . 			    origin := origin - (10@0).	 ]. keyValue = 11 "page up "   ifTrue: [ 	Transcript show: ' page up ' ; cr . 			    origin := origin - (0@30).	 ]. keyValue = 12 "page down "   ifTrue: [ 	Transcript show: ' page down' ; cr . 			    origin := origin + (0@30).	 ]. keyValue = 61 " plus equals "   ifTrue: [ 	Transcript show: ' plus equals down' ; cr . 			    box_size := box_size + 1 . 	 ]. keyValue = 45 " minus underscore "   ifTrue: [ 	Transcript show: ' minus underscore ' ; cr . 			    box_size := (box_size - 1) max: 1 . 			    	 ].keyValue = 27 " escape key "   ifTrue: [ 	Transcript show: ' escape key ' ; cr .      self delete. 			    	 ].	Transcript show: ' keystroke origin => ' ; show: origin ; cr .   self changed .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.615259+00:00'!keyUp: anEvent Transcript show: ' key up ' ; show: anEvent  ; cr .  ^ true! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.615606+00:00'!handlesKeystroke: anEvent ^ true .! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.617654+00:00'!plotWalls: anObject  walls := anObject. ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.618262+00:00'!initialize  | ox oy | ox := 0 - 61 .  oy := 0 - 23 .  super initialize. self extent: (1900@970). origin := ox @ oy  . "explicit " walls := nil ." self extent: (600@600).  origin := (0@0)." box_size := 5 . ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.620553+00:00'!plotPoint: aPt onCanvas: aCanvas withColor: aColor" requires walls be defined " | xy local_xy local_xy2 okX okY position |      position := self position .  		xy := ((aPt - ((walls minX)@(walls minY)) - origin) * box_size) .		okX := (xy x) < (self extent x) and: [ (xy x) >= 0 ].		okY := (xy y) < (self extent y) and: [ (xy y) >= 0 ].		(okX and:[ okY ifTrue: [				local_xy := xy + position. 				local_xy2 := local_xy + (box_size@box_size).             aCanvas fillRectangle: (local_xy corner:local_xy2) color: aColor.				]]).				      		  ! !!Day17Morph methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.620964+00:00'!plotWater: anObject  water := anObject. ! !Object subclass: #Day17Water	instanceVariableNames: 'points'	classVariableNames: ''	package: 'Advent-Of-Code-2018'!!Day17Water commentStamp: '2025-11-15T10:46:04.273047+00:00' prior: 0!a dumb class to hold a set of points ```w points => returns a set of known pointsw addPoint: p  => adds a point to set of known points```!!Day17Water methodsFor: 'initialization' stamp: '2025-11-15T14:00:57.323516+00:00'!initialize  points := Set new .! !!Day17Water methodsFor: 'initialization' stamp: '2025-11-15T14:00:57.325444+00:00'!points ^ points! !!Day17Water methodsFor: 'initialization' stamp: '2025-11-15T14:00:57.32746+00:00'!addPoint: aPt points add: aPt . ! !Morph subclass: #Day17Solver	instanceVariableNames: 'water walls'	classVariableNames: ''	package: 'Advent-Of-Code-2018'!!Day17Solver commentStamp: '2025-11-15T01:57:08.48883+00:00' prior: 0!Day17 translate(d) text input ```x=123, y=456..789```likely PetitParser2 is not available , so i included post-parsed data```d := Day17 new.d range: (d puzzleInput1 )." after ranging input we have a set of points to plot "d points. ds := Day17Solver new.ds solve: (d points) .dm := Day17Morph new.dm openInWorld.dm plot: ds .```!!Day17Solver methodsFor: 'initialization' stamp: '2025-11-15T14:00:57.331758+00:00'!setupWalls: w walls := w . water := Day17Water new.! !!Day17Solver methodsFor: 'initialization' stamp: '2025-11-15T14:02:01.622025+00:00'!initialize  self halt "should not implement - use setup instead"! !